<% content_for :header_title, "Questionnare flowcharts" %>

<form action="" method="get">
<p>
    <label>Select jurisdiction</label>
    <%= select_tag(:jurisdiction, jurisdiction_options_for_select(@jurisdiction)) %>
    <%= submit_tag 'Submit', :class => 'btn btn-primary btn-submit' %>
</p>
</form>

<div id="key">
  <p id="pilotkey"><span></span> Needed for Pilot level</p>
  <p id="standardkey"><span></span> Needed for Standard level</p>
  <p id="exemplarkey"><span></span> Needed for Exemplar level</p>
</div>

<div id="flowchart">
  <div class="mermaid">
  graph LR
  <% @questions.each_with_index do |q, index| %>
    <% next if @questions[index + 1].nil? %>
    <%= render partial: "question.txt", locals: { question: q, index: index } %>
  <% end %>
  <%= @deps.reverse.join("\r\n").gsub("â€™", "'") %>
  <% @levels.each do |k, l| %>
    <% unless k.nil? %>
      class <%= l.join(",") %> <%= k %>;
    <% end %>
  <% end %>
  </div>
</div>

<% content_for :foot_scripts do %>
  mermaid.initialize({startOnLoad:true});
<% end %>
